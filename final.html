<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>PC Parts AR</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>

    <style>
  body {
    margin: 0;
    overflow: hidden;
    font-family: "Segoe UI", Arial, sans-serif;
  }
.ui-overlay {
  position: fixed;
  top: 20px;
  width: 100%;
  display: flex;
  justify-content: center;
  pointer-events: none;
  z-index: 10;
}

.ui-box {
  background: rgba(0, 0, 0, 0.45);
  padding: 15px 30px;
  border-radius: 12px;
  backdrop-filter: blur(6px);
  color: #fff;
  font-size: 1.6em;
  letter-spacing: 1.2px;
  font-weight: 600;
  box-shadow: 0 0 15px rgba(0, 200, 255, 0.35);
}

.pulse {
  animation: pulseText 2s infinite;
}

@keyframes pulseText {
  0% { opacity: 0.4; }
  50% { opacity: 1; }
  100% { opacity: 0.4; }
}

.back-btn {
  position: fixed;
  bottom: 25px;
  left: 25px;
  padding: 15px 35px;
  background: rgba(0, 0, 0, 0.55);
  color: white;
  border-radius: 12px;
  font-size: 1.3em;      /* Bigger */
  font-weight: 600;
  backdrop-filter: blur(6px);
  text-decoration: none;
  box-shadow: 0 0 15px rgba(0, 255, 128, 0.4);
  z-index: 20;
  transition: 0.25s ease;
}

.back-btn:hover {
  background: rgba(0, 0, 0, 0.75);
  transform: scale(1.07);
}


</style>

  </head>

  <a href="home.html" class="back-btn">Back</a>
  <body>

<div class="ui-overlay">
  <div class="ui-box">
    <span class="pulse">Scan your marker</span>
  </div>
</div>


    <a-scene embedded arjs="sourceType: webcam;">
      <a-assets id="assetContainer"></a-assets>
      <a-entity id="markerContainer"></a-entity>
      <a-entity camera></a-entity>
    </a-scene>

    <script>
      //  LIST PC PARTS 
      const pcParts = [
        { id: "case", label: "CASE", pos: "-1 -3 0", rot: "-90 180 180", scale: "0.5 0.5 0.5"  },
        { id: "cpu", label: "CPU", pos: "0 0 0", rot: "0 -90 0", scale: "0.1 0.1 0.1" },
        { id: "fan", label: "FAN", pos: "0 0 0", rot: "0 0 0", scale: "20 20 20" },
        { id: "hdd", label: "HDD", pos: "0 0 0", rot: "180 180 0", scale: "0.5 0.5 0.5" },
        { id: "keyboard", label: "KEYBOARD", pos: "0 0 0", rot: "0 -90 0", scale: "0.1 0.1 0.1" },
        { id: "monitor", label: "MONITOR", pos: "0 1 0", rot: "-90 0 0", scale: "6 6 6" },
        { id: "motherboard", label: "MOTHERBOARD", pos: "0 1 0", rot: "0 90 0", scale: "2 2 2" },
        { id: "mouse", label: "MOUSE", pos: "0 0 0", rot: "0 -90 0", scale: "1 1 1"},
        { id: "psu", label: "PSU", pos: "0 0 0", rot: "90 0 180", scale: "0.1 0.1 0.1" },
        { id: "ram", label: "RAM", pos: "0 0 0", rot: "0 180 180", scale: "20 20 20" },
        { id: "ssd", label: "SSD", pos: "0 0 0", rot: "0 0 0", scale: "0.5 0.5 0.5" },
        { id: "gpu", label: "GPU", pos: "0 0 0", rot: "-90 0 0", scale: "1 1 1" },
      ];

      const assetContainer = document.getElementById("assetContainer");
      const markerContainer = document.getElementById("markerContainer");

      // AUTO-SIZING LABEL BG
      function updateBackgroundWidth(textEl, bgEl) {
        const value = textEl.getAttribute("value");
        const charWidth = 0.18;
        const padding = 0.4;

        const textWidth = value.length * charWidth;
        bgEl.setAttribute("width", textWidth + padding);
      }

      // Generate assets + markers
      pcParts.forEach(part => {
        const { id, label, pos, rot, scale } = part;

        assetContainer.insertAdjacentHTML(
          "beforeend",
          `
            <a-asset-item id="model-${id}" src="models/${id}.glb"></a-asset-item>
            <audio id="audio-${id}" src="sounds/${id}.mp3" preload="auto"></audio>
          `
        );

        markerContainer.insertAdjacentHTML(
          "beforeend",
          `
            <a-marker type="pattern" url="markers/${id}.patt" id="marker-${id}">
              <a-entity 
                gltf-model="#model-${id}"
                position="${pos}"
                rotation="${rot}"
                scale="${scale}">
              </a-entity>

              <a-entity id="label-${id}" position="0 0 2" rotation="-90 0 0">

                <a-plane 
                  id="bg-${id}" 
                  color="white" 
                  opacity="0.7"
                  height="0.5"
                  width="4"
                  position="0 0 0.01">
                </a-plane>

                <a-text 
                  id="text-${id}"
                  value="${label}"
                  align="center"
                  color="black"
                  position="0 0 0.05"
                  scale="2 2 2">
                </a-text>

              </a-entity>

              <a-sound id="sound-${id}" src="#audio-${id}" autoplay="false" volume="2"></a-sound>
            </a-marker>
          `
        );
      });

      // Sound + auto resize label
      pcParts.forEach((part) => {
        const marker = document.getElementById(`marker-${part.id}`);

        marker.addEventListener("markerFound", () => {
          const sound = document.getElementById(`sound-${part.id}`);
          const textEl = document.getElementById(`text-${part.id}`);
          const bgEl = document.getElementById(`bg-${part.id}`);

          if (sound.components.sound) sound.components.sound.playSound();
          updateBackgroundWidth(textEl, bgEl);
        });

        marker.addEventListener("markerLost", () => {
          const sound = document.getElementById(`sound-${part.id}`);
          if (sound.components.sound) sound.components.sound.stopSound();
        });
      });

    </script>

  </body>
</html>
